[package]
name = "codemp"
version = "0.6.0"
edition = "2021"

[lib]
name = "codemp"

[dependencies]
# core
tracing = "0.1"
# woot
codemp-woot = { git = "ssh://git@github.com/codewithotherpeopleandchangenamelater/woot.git", features = ["serde"], tag = "v0.1.2", optional = true }
# proto
uuid = { version = "1.3.1", features = ["v4"], optional = true }
tonic = { version = "0.9", features = ["tls", "tls-roots"], optional = true }
prost = { version = "0.11.8", optional = true }
# api
similar = { version = "2.2", features = ["inline"], optional = true }
tokio = { version = "1.0", features = ["macros", "rt-multi-thread", "sync"], optional = true }
async-trait = { version = "0.1", optional = true }
# client
md5 = { version = "0.7.0", optional = true }
serde_json = { version = "1", optional = true }
tokio-stream = { version = "0.1", optional = true }
serde = { version = "1.0.193", features = ["derive"] }
dashmap = { version = "5.5.3", optional = true }
postcard = { version = "1.0.8", optional = true }

[build-dependencies]
tonic-build = "0.9"

[features]
default = []
api     = ["dep:async-trait"]
woot    = ["dep:codemp-woot", "dep:similar"]
proto   = ["dep:prost", "dep:tonic", "dep:uuid"]
client  = ["proto", "api", "dep:tokio", "dep:tokio-stream", "dep:uuid", "dep:md5", "dep:serde_json", "dep:dashmap", "dep:postcard"]
server  = ["proto", "woot"]
